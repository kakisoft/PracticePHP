#### イベント一覧を表示
```
php artisan event:list
```

________________________________________________________________________
## イベントを使う理由
https://reffect.co.jp/laravel/laravel-event-listener  

#### なぜイベントを使うのか？
本書ではユーザ登録後に行うメール送信やメルマガ登録をイベントを利用して行います。  
それらの処理はイベントを使用しなくても実装することができますがイベントを利用することでコントローラー(メインのファイル)に記述するコード量が少なくなる上、  
メール送信、メルマガ登録という処理を別のクラス(別ファイル)にわけることでコードのメンテナンスが楽になります。  
また新たにSlack送信という処理を追加することになってもコントローラー(メインのファイル)のコード変更を行うことなく他への影響を最小限に抑えて処理の追加を行うことができます。  
不要になった処理の削除についてもコントローラーとは別に処理毎にファイルが作成されているので削除も簡単に行うことができます。


##### イベントを使わない場合
```
＜コントローラ＞
　　　メール送信
　　　　　↓
　　　メルマガ登録
　　　　　↓
　　　Slack送信
```

##### イベントを使った場合
```
＜コントローラ＞
　　　イベント　→　リスナー ： メール送信
　　　　　　　　→　リスナー ： メルマガ登録
　　　　　　　　→　リスナー ： Slack送信
```

________________________________________________________________________
## CQRS (Command Query Responsibility Segregation)：コマンドクエリ責務分析
書き込み（コマンド）と、読み込み（クエリ）は、別々に取り扱うべき、という考え方。（設計パターン）

________________________________________________________________________
## 用語

### イベント（ Event ）
何かしらの動作や変更などが発生した際に発信されるもの。   
発生時の情報をオブジェクトとして表現する。  

### リスナー（ Listener ）
イベントに対応する処理を実行する機能。  

サーバサイドで同期的に処理 or キューと組み合わせて非同期で実行可。  

### ディスパッチャー（ Dispatcher ）
イベントを発行する機能。  
リスナークラスの実装次第で、サーバサイドでリスナーを起動させるか、socket.io（websocket）を通してWebブラウザに実行させるかをディスパッチャーが振り分ける。  

また、event ヘルパー関数を通して利用する事もできる。  

________________________________________________________________________
## イベントクラスの雛形に含まれるトレイト

|  トレイト                                       |  内容                                                |
|:-----------------------------------------------|:-----------------------------------------------------|
|  Illuminate\Queue\InteractsWithQueue           |  Queue と組み合わせて非同期イベントを実行する時に利用    |
|  Illuminate\Foundation\Events\Dispatchable     |  イベントクラスにて Dispatcher として作用させる時に利用  |
|  Illuminate\Broadcasting\InteractsWithSockets  |  socket.io を使ってブラウザにイベント通知する時に利用    |


```php
class AccessDetection
{
    use Dispatchable, InteractsWithSockets, SerializesModels;
```

```php
abstract class AbstractJob implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels; 
```

________________________________________________________________________
________________________________________________________________________
________________________________________________________________________
# aaa
https://laravel.com/docs/8.x/eloquent  

「ユーザを追加した時、メールを送信するイベントを発火」みたいな用途とかも。  
（Observer でも可）  

```php
class User extends Model
{
    /**
     * The "booted" method of the model.
     *
     * @return void
     */
    protected static function booted()
    {
        static::addGlobalScope(new AncientScope);
    }
}
```


同じことを　Observer でも出来そう。

