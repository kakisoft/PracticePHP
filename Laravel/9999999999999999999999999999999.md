# 郵便番号住所変換の説明

## ER図
![x](resources/ZipCodeToAddressConversion_ER.png)  

## スキーマ詳細
 * [zip_code_to_address_conversions](../schema_hapilogi/zip_code_to_address_conversions.md)  

## 備考
郵便番号に対応する住所を保持しています。  

日本郵便局からダウンロードしたデータを使用します。  
https://www.post.japanpost.jp/zipcode/download.html  

## 概要
「住所の郵便番号」「事業所の個別郵便番号」の両方に対応可能予定です。  

__________________________________________________________________________
https://www.post.japanpost.jp/zipcode/download.html


住所の郵便番号（ローマ字）（CSV形式）  


事業所の個別郵便番号（CSV形式）  


## KEN_ALL_ROME.CSV  ：  住所の郵便番号

|  A       |  B    |  C        |  D              |  E         |  F                    |  G                           |
|:---------|:------|:----------|:----------------|:-----------|:----------------------|:-----------------------------|
|  600000  |  北海道  |  札幌市　中央区  |  以下に掲載がない場合     |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  IKANIKEISAIGANAIBAAI        |
|  640941  |  北海道  |  札幌市　中央区  |  旭ケ丘            |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  ASAHIGAOKA                  |
|  600041  |  北海道  |  札幌市　中央区  |  大通東            |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  ODORIHIGASHI                |
|  600042  |  北海道  |  札幌市　中央区  |  大通西（１～１９丁目）    |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  ODORINISHI(1-19-CHOME)      |
|  640820  |  北海道  |  札幌市　中央区  |  大通西（２０～２８丁目）   |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  ODORINISHI(20-28-CHOME)     |
|  600031  |  北海道  |  札幌市　中央区  |  北一条東           |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA1-JOHIGASHI             |
|  600001  |  北海道  |  札幌市　中央区  |  北一条西（１～１９丁目）   |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA1-JONISHI(1-19-CHOME)   |
|  640821  |  北海道  |  札幌市　中央区  |  北一条西（２０～２８丁目）  |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA1-JONISHI(20-28-CHOME)  |
|  600032  |  北海道  |  札幌市　中央区  |  北二条東           |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA2-JOHIGASHI             |
|  600002  |  北海道  |  札幌市　中央区  |  北二条西（１～１９丁目）   |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA2-JONISHI(1-19-CHOME)   |
|  640822  |  北海道  |  札幌市　中央区  |  北二条西（２０～２８丁目）  |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA2-JONISHI(20-28-CHOME)  |
|  600033  |  北海道  |  札幌市　中央区  |  北三条東           |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA3-JOHIGASHI             |
|  600003  |  北海道  |  札幌市　中央区  |  北三条西（１～１９丁目）   |  HOKKAIDO  |  SAPPORO SHI CHUO KU  |  KITA3-JONISHI(1-19-CHOME)   |

https://www.post.japanpost.jp/zipcode/dl/readme_ro.html
```
1. 郵便番号（7桁）・・・・・・・・・・・・・・・・・・・・・半角数字
2. 都道府県名・・・・・・・・・・・・・・・・・・・・・・・・漢字（コード順に掲載）（注1，2）
3. 市区町村名・・・・・・・・・・・・・・・・・・・・・・・・漢字（コード順に掲載）（注1，2）
4. 町域名　　　・・・・・・・・・・・・・・・・・・・・・・・・漢字（五十音順に掲載）（注1，2）
5. 都道府県名・・・・・・・・・・・・・・・・・・・・・・・・ヘボン式ローマ字　半角大文字（注3）
6. 市区町村名・・・・・・・・・・・・・・・・・・・・・・・・ヘボン式ローマ字　半角大文字（注3）
7. 町域名　　　・・・・・・・・・・・・・・・・・・・・・・・・ヘボン式ローマ字　半角大文字（注3）
```


## JIGYOSYO.CSV  ：  事業所の個別郵便番号

|  A     |  B                                                                                        |  C                                           |  D    |  E       |  F     |  G                     |  H       |  I    |  J     |  K    |  L    |  M    |
|:-------|:------------------------------------------------------------------------------------------|:---------------------------------------------|:------|:---------|:-------|:-----------------------|:---------|:------|:-------|:------|:------|:------|
|  1101  |  (ｶﾌﾞ) ﾆﾎﾝｹｲｻﾞｲｼﾝﾌﾞﾝｼﾔ ｻﾂﾎﾟﾛｼｼﾔ                                                           |  株式会社　日本経済新聞社　札幌支社                           |  北海道  |  札幌市中央区  |  北一条西  |  ６丁目１－２アーバンネット札幌ビル２Ｆ   |  608621  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｲﾂﾊﾟﾝｻﾞｲﾀﾞﾝﾎｳｼﾞﾝ ｻﾂﾎﾟﾛｼｺｳﾂｳｼﾞｷﾞﾖｳｼﾝｺｳｺｳｼﾔ                                                |  一般財団法人　札幌市交通事業振興公社                          |  北海道  |  札幌市中央区  |  大通西   |  ５丁目地下鉄大通駅西側コンコース内     |  608614  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｲﾄｳｸﾞﾐﾄﾞｹﾝ ｶﾌﾞｼｷｶﾞｲｼﾔ                                                                    |  伊藤組土建　（株）                                   |  北海道  |  札幌市中央区  |  北四条西  |  ４丁目１番地                |  608554  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｲﾄｳﾁﾕｳｼﾖｳｼﾞ ｶﾌﾞｼｷｶﾞｲｼﾔ ﾎﾂｶｲﾄﾞｳｼｼﾔ                                                        |  伊藤忠商事　株式会社　北海道支社                            |  北海道  |  札幌市中央区  |  北三条西  |  ３丁目１番地大同生命札幌ビル        |  608547  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｲﾘﾖｳﾎｳｼﾞﾝ ｲｼﾞﾝｶｲ ﾅｶﾑﾗｷﾈﾝﾋﾞﾖｳｲﾝ                                                           |  医療法人　医仁会　中村記念病院                             |  北海道  |  札幌市中央区  |  南一条西  |  １４丁目                  |  608570  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｲﾜﾀﾁｻﾞｷｹﾝｾﾂ ｶﾌﾞｼｷｶﾞｲｼﾔ                                                                   |  岩田地崎建設　株式会社                                 |  北海道  |  札幌市中央区  |  北二条東  |  １７丁目２番地               |  608630  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｴ-ｱｲ-ｼﾞ-ｴｼﾞｿﾝｾｲﾒｲﾎｹﾝ ｶﾌﾞｼｷｶｲｼﾔ ﾎﾂｶｲﾄﾞｳｼﾞﾑｾﾝﾀ-                                            |  ＡＩＧエジソン生命保険　株式会社　北海道事務センター                  |  北海道  |  札幌市中央区  |  北一条西  |  ４丁目２－２札幌ノースプラザ１０Ｆ     |  608613  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｴﾑｴﾑｴｽ ﾏﾝｼﾖﾝﾏﾈ-ｼﾞﾒﾝﾄｻ-ﾋﾞｽ ｶﾌﾞｼｷｶｲｼﾔ                                                      |  エムエムエス　マンションマネージメントサービス　（株）                 |  北海道  |  札幌市中央区  |  南一条西  |  ４丁目２０番地               |  608537  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶ) ｼﾞｴｲﾃｲﾋﾞ-ﾎﾂｶｲﾄﾞｳｼﾞｷﾞﾖｳﾌﾞ ｴｲｷﾞﾖｳﾀﾞｲﾖﾝｶﾅｲ ﾎﾂｶｲﾄﾞｳｷﾕｳｷﾞﾖｳｷﾖｳﾘﾖｸ･ｶﾝｾﾝﾘｽｸﾃｲｹﾞﾝｼｴﾝｷﾝｼﾞﾑｷﾖｸ  |  （株）　ＪＴＢ北海道事業部　営業第４課内　北海道休業協力・感染リスク低減支援金事務局  |  北海道  |  札幌市中央区  |  北一条西  |  ６丁目１－２アーバンネット札幌ビル８階   |  608791  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶ) ﾎﾂｶｲﾄﾞｳﾆｼﾞﾕｳｲﾂｾｲｷｿｳｺﾞｳｹﾝｷﾕｳｼﾖ                                                         |  株式会社　北海道二十一世紀総合研究所                          |  北海道  |  札幌市中央区  |  大通西   |  ３丁目１１番地北洋ビル           |  608640  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶﾌﾞ ﾄｳｷﾕｳﾋﾔﾂｶﾃﾝ ｻﾂﾎﾟﾛﾃﾝ                                                                  |  株式会社　東急百貨店　札幌店                              |  北海道  |  札幌市中央区  |  北四条西  |  ２丁目１                  |  608619  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶﾌﾞｼｷｶｲｼﾔ ｱｻﾋｼﾝﾌﾞﾝｼﾔ ﾎﾂｶｲﾄﾞｳｼｼﾔ                                                          |  株式会社　朝日新聞社　北海道支社                            |  北海道  |  札幌市中央区  |  北１条西  |  １丁目６番地さっぽろ創生スクエア９階    |  608602  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶﾌﾞｼｷｶｲｼﾔ ﾆﾂｾﾝﾚﾝｴｽｺ-ﾄ                                                                    |  株式会社　ニッセンレンエスコート                            |  北海道  |  札幌市中央区  |  南二条西  |  ２丁目１３番地               |  608508  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶﾌﾞｼｷｶｲｼﾔ ﾎﾂｶｲﾄﾞｳﾆﾂｶﾝｽﾎﾟ-ﾂｼﾝﾌﾞﾝｼﾔ                                                        |  株式会社　北海道日刊スポーツ新聞社                           |  北海道  |  札幌市中央区  |  北三条東  |  ３丁目１－３０               |  608521  |  60   |  札幌中央  |  0    |  0    |  0    |
|  1101  |  ｶﾌﾞｼｷｶｲｼﾔ ﾕｳﾁﾖｷﾞﾝｺｳ ｻﾂﾎﾟﾛｼﾃﾝ                                                             |  株式会社　ゆうちょ銀行　札幌支店                            |  北海道  |  札幌市中央区  |  北二条西  |  ４丁目３番地                |  608797  |  60   |  札幌中央  |  0    |  0    |  0    |


https://www.post.japanpost.jp/zipcode/dl/jigyosyo/readme.html
```
※1   大口事業所の所在地のJISコード（5バイト）
※2   大口事業所名（カナ）（100バイト）
※3   大口事業所名（漢字）（160バイト）
※4   都道府県名（漢字）（8バイト）
※5   市区町村名（漢字）（24バイト）
※6   町域名（漢字）（24バイト）
※7   小字名、丁目、番地等（漢字）（124バイト）
※8   大口事業所個別番号（7バイト）
※9   旧郵便番号（5バイト）
※10  取扱局（漢字）（40バイト）
※11  個別番号の種別の表示（1バイト）「0」大口事業所「1」私書箱
※12  複数番号の有無（1バイト）
「0」複数番号無し
「1」複数番号を設定している場合の個別番号の1
「2」複数番号を設定している場合の個別番号の2
「3」複数番号を設定している場合の個別番号の3
一つの事業所が同一種別の個別番号を複数持つ場合に複数番号を設定しているものとします。

従って、一つの事業所で大口事業所、私書箱の個別番号をそれぞれ一つづつ設定している場合は 12）は「0」となります。

※13  修正コード（1バイト）
「0」修正なし
「1」新規追加
「5」廃止
```

__________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________
# 2021/04/07 : 開発時の疑問点
https://bwave.backlog.com/view/BBP-720
```
１．日本郵政 or 国土地理院

結論：日本郵便が配布しているデータを使う
（日本郵政が郵便番号が公式）

２．郵便番号と住所のチェック（送状発行システム向けチェック機能）

エラーチェック不要。
（ちなみに、ヤマトの郵便番号チェックの大元は、日本郵便。）
どうしても付けるなら、オプション設定。

３．テーブル構成の修正について

以下のカラムを保持するように変更

・住所用の郵便番号なのか or 事業所用の郵便番号なのかを識別するフラグを保持
・郵便番号（7桁）
・都道府県名
・市区町村名
・町域名
・番地

「事業所名」「事業所名カナ」といった情報は保持しない。


４．更新方法

 - 1，夜間バッチ。日本郵便のページからダウンロードして更新。
https://www.post.japanpost.jp/zipcode/dl/oogaki-zip.html
file_get_contents で URL を指定して拾ってくるイメージ。
2021年3月の更新ファイルなら「add_2103.zip」、2021年3月廃止データなら「del_2103.zip」、といった特定方法。
日本郵便のダウンロードURLが変わらない事が前提なので、対象URLはコンフィグで保持。

 - 2．人力アップロード
 CSVファイルをアップロードする画面を用意。


５．フロントに渡すデータ
（協議中）
```
